# CSS和JS的装载与执行

## 1.页面加载渲染的过程

html首先会被渲染成DOM树，html是第一个请求回来的资源，从字节流转换成字符流，然后被解析器进行解析，通过浏览器端的词法分析，分析成对应token，通过nextToken的方式，添加到DOM树中；在解析过程中解析到对应的外链标签，会继续去请求资源；

当解析到CSS资源时，浏览器会并发的请求CSS资源，请求回来后会被渲染成CSSOM树，并且和DOM树结合成渲染树

生成渲染树后会继续执行布局，最后绘制；

## 2.HTML渲染过程的特点

- 顺序加载，并发加载：并发度受到浏览器域名限制，所以增加域名可扩大并发度；
- 是否阻塞：CSS加载是否会阻塞JS的加载和执行和页面渲染，JS加载是否会阻塞后续JS的加载和执行；
- 依赖关系：HTML渲染过程中是否存在必须的依赖关系；case：页面一进来没有样式，突然闪了一下就有了；
- 引入方式：若通过script的src引入，会有相关阻塞页面渲染；可通过defer和async标签处理js引入，不会造成页面阻塞；
  - defer：如果`script`标签设置了该属性，则浏览器会异步的下载该文件并且不会影响到后续`DOM`的渲染；
    如果有多个设置了`defer`的`script`标签存在，则会按照顺序执行所有的`script`；
    `defer`脚本会在文档渲染完毕后，`DOMContentLoaded`事件调用前执行。
  - async：`async`的设置，会使得`script`脚本异步的加载并在允许的情况下执行，
    `async`的执行，并不会按着`script`在页面中的顺序来执行，而是谁先加载完谁执行。
  - 可通过动态加载的方式，在需要这个js时，才进行加载；

## 3.执行顺序，并发加载

- 词法分析：
- 并发加载：
- 并发上限：

## 4.CSS阻塞

- css head中阻塞页面的渲染：head中的link会阻塞页面的渲染，也就是说在页面渲染时，会带着link的样式渲染，这样可避免页面的闪动；
- css阻塞JS的执行
- css不阻塞外部脚本的加载